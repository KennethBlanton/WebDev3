var OneKOID=window.OneKOID||{};
OneKOID.IntervalHandler=(function(){function a(g,d,c,f){var e,b=0;
e=setInterval(function(){b+=c;
if(d){g();
clearInterval(e)
}if(b===f){clearInterval(e)
}},c)
}return{waitLoadElement:a}
}());
var OneKOID=window.OneKOID||{};
OneKOID.LoginRegHelper=(function(){var c=false,b;
function r(u){var w=$("#capture_"+u+"_gender_male_0"),v=$("#capture_"+u+"_gender_female_1");
w.on("change",function(){$("#capture_"+u+"_form_collection_gender .capture_tip_error").hide()
});
v.on("change",function(){$("#capture_"+u+"_form_collection_gender .capture_tip_error").hide()
})
}function t(u){var v=$("#capture_"+u+"_address_state");
if(v.length){v.parent().parent().append('<div class="capture_tip" style="display:none;"></div>').append('<div class="capture_tip_validating" data-elementname="address_state">Validating</div>').append('<div class="capture_tip_error" data-elementname="address_state"></div>')
}v.on("focus",function(){v.parent().removeClass("capture_error").addClass("capture_validated");
v.parent().siblings(".capture_tip_error").html("")
})
}function l(){var u=document.getElementById("signIn"),w=document.getElementById("returnSocial"),v=document.getElementById("returnTraditional");
u.style.display="none";
u.setAttribute("hidden","");
w.style.display="none";
w.setAttribute("hidden","");
v.style.display="none";
v.setAttribute("hidden","")
}function e(){var u=document.getElementById("signIn"),v=document.getElementById("socialRegistration"),w=document.getElementById("traditionalRegistration");
u.style.display="none";
u.setAttribute("hidden","");
v.style.display="none";
v.setAttribute("hidden","");
w.style.display="none";
w.setAttribute("hidden","")
}function a(u){if(u==="legalAcceptanceScreen"||u==="requirementsScreen"){var v=document.getElementById("capture_"+u+"_hidden_residencyData").value;
if(v&&v==="US"){document.getElementById("capture_"+u+"_residency").checked=true
}}}function h(v){if(v==="signIn"||v==="returnTraditional"){var w=$("#capture_"+v+"_traditionalSignIn_emailAddress"),u=$("#capture_"+v+"_traditionalSignIn_password");
if(!w.parent().find("label").length){w.parent().prepend('<label for="'+w.attr("id")+'">'+w.attr("placeholder")+"</label>")
}if(!u.parent().find("label").length){u.parent().prepend('<label for="'+u.attr("id")+'">'+u.attr("placeholder")+"</label>")
}}}function g(v){if(v==="forgotPassword"){var u=$("#capture_forgotPassword_traditionalSignIn_emailAddress");
if(!u.parent().find("label").length){u.parent().prepend('<label for="'+u.attr("id")+'">'+u.attr("placeholder")+"</label>")
}}}function f(u){var v=$("#capture_"+u+"_residency");
v.on("change",function(){$("#capture_"+u+"_form_item_residency .capture_tip_error").hide()
})
}function k(){$("#janrainModal .providers li a").removeAttr("tabindex")
}function i(u){if(u==="invalidCredentials"){OneKOID.IntervalHandler.waitLoadElement(function(){var v=$("#capture_signIn_userInformationForm_errorMessages:visible"),w=v.find("div:visible");
if(v.length&&w.length&&w.html()!==""){w.attr("aria-live","assertive");
w.attr("role","alert");
w.attr("tabindex","-1");
w.focus()
}},($("#capture_signIn_userInformationForm_errorMessages:visible").length===1),50,2000)
}}function p(u){if(u==="invalidAccountIdentifier"){OneKOID.IntervalHandler.waitLoadElement(function(){var w=$("#capture_forgotPassword_forgotPasswordForm_errorMessages"),v=w.find("div:visible");
if(w.length&&v.length&&v.html()!==""){v.attr("aria-live","assertive");
v.attr("role","alert");
v.attr("tabindex","-1");
v.focus()
}},($("#capture_forgotPassword_forgotPasswordForm_errorMessages:visible").length===1),50,2000)
}}function q(){c=true
}function s(){c=false
}function d(u){b=u
}function o(){if(c){OneKOID.FormUtility.focusOnError();
s()
}}function m(){if(b){$("#alreadyLoggedIn").show();
$("#signIn").hide();
$("#traditionalRegistration").hide();
$("#returnTraditional").hide();
$("#returnSocial").hide();
$("#signin-regstration-body-background").show()
}}function n(v,w,u){return(/^[A-Za-z0-9._+\-]+@[A-Za-z0-9.\-]+\.[A-Za-z]{2,4}$/).test(w)
}function j(v,w,u){return(/^(?!p\.?o\.?\sbox|post\soffice|P\.O\. BOX|P\.O\.| PO\.|POBOX|box| PO |p\.o\. box|p\.o\.| p\.o\. | p\.o\.| po\.| p\.o | p\.o| bin | po | ^po| bin\.| Bin | BIN\.| BIN | ^BIN|pobox";\"(^BOX[\s|\.]*.*)|(^BIN[\s|\.]*.*)|(.*P[\s|\.|,]*(OST)?[\s|\.]*O[\s|\.|,]*((FFICE)|(FICE))?[\s|\.]*((BOX)|(BIN))[\s|\.]*.*)).*$/i).test(w)
}return{fixGenderField:r,fixStateField:t,hideReturnLinks:l,hideRegistrationLinks:e,checkResidencyField:a,addLabelsToSignInFields:h,addLabelToForgotPasswordField:g,fixResidencyField:f,fixJanrainProvidersTabIndex:k,focusOnInvalidCredentials:i,focusOnForgotPasswordError:p,setServerError:q,setSession:d,focusIfServerError:o,showAlreadyLoggedInScreen:m,removeServerError:s,emailValidation:n,addressValidation:j}
}());
var OneKOID=window.OneKOID||{};
OneKOID.ModalHelper=(function(){function a(b){if(b){$(".login_loading_modal").show()
}}return{activateLoadingScreen:a}
}());
var LoginRegHandlers=function(a){janrain.settings.capture.recaptchaVersion=2;
this.settings=a
};
LoginRegHandlers.prototype.serverValidationFailedHandler=function(){OneKOID.LoginRegHelper.setServerError()
};
LoginRegHandlers.prototype.loginSuccessHandler=function(a){OneKOID.LoginRegHelper.hideReturnLinks();
OneKOID.AuthVisibility.showSignedInLinks();
OneKOID.AuthVisibility.showProfileImage();
OneKOID.AuthAPIHelper.setSSO(a.ssoImplicitLogin)
};
LoginRegHandlers.prototype.sessionFoundHandler=function(){OneKOID.AuthVisibility.hideResetPasswordRequestCode();
OneKOID.AuthVisibility.showSignedInLinks();
OneKOID.AuthVisibility.showProfileImage()
};
LoginRegHandlers.prototype.sessionNotFoundHandler=function(){OneKOID.AuthControl.removeAccessTokenCookie();
OneKOID.AuthVisibility.hideProfileImage();
OneKOID.AuthVisibility.showSignedOutLinks()
};
LoginRegHandlers.prototype.sessionEndedHandler=function(){OneKOID.AuthControl.removeAccessTokenCookie();
OneKOID.AuthVisibility.showSignedOutLinks();
OneKOID.AuthVisibility.hideProfileImage();
if(!OneKOID.JanrainSettings.isSSOEnabled){OneKOID.AuthAPIHelper.endSession(OneKOID.JanrainSettings.janrainnaapidomain,OneKOID.AuthAPIHelper.doRedirectOnSignOut)
}};
LoginRegHandlers.prototype.registrationSuccessHandler=function(){OneKOID.LoginRegHelper.hideRegistrationLinks();
OneKOID.AuthVisibility.showSignedInLinks();
OneKOID.AuthVisibility.showProfileImage()
};
LoginRegHandlers.prototype.screenShowHandler=function(a){OneKOID.Accessibility.hideAccountInfoInstructions(a.screen,"traditionalRegistration",this.settings.tradModelHideInstructions);
OneKOID.Accessibility.hideAccountInfoInstructions(a.screen,"socialRegistration",this.settings.socialModelHideInstructions);
OneKOID.Accessibility.hideAccountInfoInstructions(a.screen,"legalAcceptances",this.settings.legalModelHideInstructions);
OneKOID.Accessibility.hideAccountInfoInstructions(a.screen,"requirementsScreen",this.settings.reqModelHideInstructions);
OneKOID.LoginRegHelper.checkResidencyField(a.screen);
OneKOID.LoginRegHelper.addLabelsToSignInFields(a.screen);
OneKOID.LoginRegHelper.addLabelToForgotPasswordField(a.screen);
OneKOID.LoginRegHelper.fixResidencyField(a.screen);
OneKOID.LoginRegHelper.fixGenderField(a.screen);
OneKOID.LoginRegHelper.fixStateField(a.screen);
OneKOID.FormUtils.addRequiredHTMLProperty(a.screen);
setTimeout(function(){OneKOID.FormUtility.focusOnFirstInput();
OneKOID.LoginRegHelper.focusIfServerError()
},1);
if(a&&a.screen==="traditionalRegistration"){OneKOID.Events.publish("traditional-registration-screen-show")
}if(a&&a.screen==="socialRegistration"){OneKOID.Events.publish("social-registration-screen-show")
}};
LoginRegHandlers.prototype.loginFailedHandler=function(a){if(a.statusMessage==="accountDeactivated"){janrain.capture.ui.renderScreen("deactivatedAccount")
}OneKOID.LoginRegHelper.focusOnInvalidCredentials(a.statusMessage)
};
LoginRegHandlers.prototype.saveFailedHandler=function(a){OneKOID.LoginRegHelper.focusOnForgotPasswordError(a.statusMessage)
};
LoginRegHandlers.prototype.validationCompleteHandler=function(){OneKOID.FormUtility.focusOnError()
};
LoginRegHandlers.prototype.profileSaveSuccess=function(){OneKOID.AuthVisibility.showSignedInLinks();
OneKOID.AuthVisibility.showProfileImage()
};
var LoginRegHandlers=window.LoginRegHandlers||{};
function LoginRegEmbedded(a){janrain.settings.type="embed";
LoginRegHandlers.call(this,a)
}LoginRegEmbedded.prototype=Object.create(LoginRegHandlers.prototype);
LoginRegEmbedded.prototype.constructor=LoginRegEmbedded;
LoginRegEmbedded.prototype.sessionFoundHandler=function(){LoginRegHandlers.prototype.sessionFoundHandler.call(this);
OneKOID.LoginRegHelper.setSession(true)
};
LoginRegEmbedded.prototype.sessionEndedHandler=function(){LoginRegHandlers.prototype.sessionEndedHandler.call(this);
janrain.capture.ui.renderScreen("signIn")
};
LoginRegEmbedded.prototype.customizationChangeHandler=function(){};
LoginRegEmbedded.prototype.screenShowHandler=function(a){LoginRegHandlers.prototype.screenShowHandler.call(this,a);
setTimeout(function(){OneKOID.LoginRegHelper.showAlreadyLoggedInScreen()
},1)
};
var LoginRegHandlers=window.LoginRegHandlers||{};
function LoginRegModal(a){janrain.settings.type="modal";
LoginRegHandlers.call(this,a)
}LoginRegModal.prototype=Object.create(LoginRegHandlers.prototype);
LoginRegModal.prototype.constructor=LoginRegModal;
LoginRegModal.prototype.loginSuccessHandler=function(a){janrain.capture.ui.modal.close();
LoginRegHandlers.prototype.loginSuccessHandler.call(this,a);
if(!a.ssoImplicitLogin){OneKOID.ModalHelper.activateLoadingScreen(this.settings.isLoadingAnimation)
}};
LoginRegModal.prototype.sessionFoundHandler=function(){janrain.capture.ui.modal.close();
LoginRegHandlers.prototype.sessionFoundHandler.call(this)
};
LoginRegModal.prototype.sessionEndedHandler=function(a){LoginRegHandlers.prototype.sessionEndedHandler.call(this,a)
};
LoginRegModal.prototype.registrationSuccessHandler=function(){janrain.capture.ui.modal.close();
LoginRegHandlers.prototype.registrationSuccessHandler.call(this);
OneKOID.ModalHelper.activateLoadingScreen(this.settings.isLoadingAnimation)
};
LoginRegModal.prototype.screenShowHandler=function(a){LoginRegHandlers.prototype.screenShowHandler.call(this,a);
OneKOID.FormUtility.createModalCloseLink()
};
LoginRegModal.prototype.customizationChangeHandler=function(){OneKOID.LoginRegHelper.fixJanrainProvidersTabIndex()
};
(function(){var OneKOID=window.OneKOID||{};
OneKOID.LoginReg={};
OneKOID.LoginReg.janrainCaptureWidgetOnLoad=function(settings,loginRegHandlers){$(document).ready(function(){OneKOID.AuthAPIHelper.handleAPIAuthentication(settings.janrainDomain)
});
return function(){eval(settings.janrainMethod);
if(OneKOID.JanrainSettings.isSSOEnabled){janrain.events.onCaptureLoginStart.addHandler(function(){window.JANRAIN.SSO.CAPTURE.check_login({sso_server:janrain.settings.capture.federateServer,client_id:janrain.settings.capture.clientId,response_method:"jsonp",response_type:janrain.settings.capture.responseType,redirect_uri:janrain.settings.capture.redirectUri,logout_uri:janrain.settings.capture.federateLogoutUri,xd_receiver:janrain.settings.capture.federateXdReceiver})
})
}janrain.events.onCaptureServerValidationFailed.addHandler(function(){loginRegHandlers.serverValidationFailedHandler()
});
janrain.events.onCaptureLoginSuccess.addHandler(function(result){loginRegHandlers.loginSuccessHandler(result)
});
janrain.events.onCaptureSessionFound.addHandler(function(){loginRegHandlers.sessionFoundHandler()
});
janrain.events.onCaptureSessionNotFound.addHandler(function(){loginRegHandlers.sessionNotFoundHandler()
});
janrain.events.onCaptureRegistrationSuccess.addHandler(function(result){loginRegHandlers.registrationSuccessHandler()
});
janrain.events.onCaptureSessionEnded.addHandler(function(result){loginRegHandlers.sessionEndedHandler(result)
});
janrain.events.onCaptureScreenShow.addHandler(function(result){loginRegHandlers.screenShowHandler(result)
});
janrain.events.onCustomizationChange.addHandler(function(){loginRegHandlers.customizationChangeHandler()
});
janrain.events.onCaptureLoginFailed.addHandler(function(result){loginRegHandlers.loginFailedHandler(result)
});
janrain.events.onCaptureSaveFailed.addHandler(function(result){loginRegHandlers.saveFailedHandler(result)
});
janrain.events.onCaptureValidationComplete.addHandler(function(){loginRegHandlers.validationCompleteHandler()
});
janrain.events.onCaptureProfileSaveSuccess.addHandler(function(){loginRegHandlers.profileSaveSuccessHandler()
});
janrain.capture.ui.registerFunction("emailValidation",OneKOID.LoginRegHelper.emailValidation);
janrain.capture.ui.registerFunction("addressValidation",OneKOID.LoginRegHelper.addressValidation);
janrain.capture.ui.start()
}
}
}());