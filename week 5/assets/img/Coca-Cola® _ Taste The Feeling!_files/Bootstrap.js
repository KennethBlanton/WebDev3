(function ensightenInit(){var ensightenOptions = {client: "coke", clientId: 1267, publishPath: "cokeprod", isPublic:0, serverComponentLocation: "nexus.ensighten.com/coke/cokeprod/serverComponent.php", staticJavascriptPath: "nexus.ensighten.com/coke/cokeprod/code/", ns: 'Bootstrapper', nexus:"nexus.ensighten.com", scUseCacheBuster: "true", enableTagAuditBeacon : "false", enablePagePerfBeacon : "false", registryNs : "ensBootstraps", generatedOn : "Thu May 25 16:00:24 GMT 2017", beaconSamplingSeedValue: 11};
if ( !window[ensightenOptions.ns] ) {
window[ensightenOptions.ns]||(window[ensightenOptions.registryNs]||(window[ensightenOptions.registryNs]={}),window[ensightenOptions.registryNs][ensightenOptions.ns]=window[ensightenOptions.ns]=function(g){function m(a){this.name="DependencyNotAvailableException";this.message="Dependency with id "+a+"is missing"}function n(a){this.name="BeaconException";this.message="There was an error durring beacon initialization";a=a||{};this.lineNumber=a.lineNumber||a.line;this.fileName=a.fileName}function p(){for(var a=
b.dataDefinitionIds.length,d=!0,e=0;e<a;e++){var c=b.dataDefinitions[b.dataDefinitionIds[e]];if(!c||null==c.endRegistration){d=!1;break}}d&&b.callOnDataDefintionComplete()}var c={},b={};b.ensightenOptions=ensightenOptions;b.scDataObj={};c.version="1.26.0";c.nexus=g.nexus||"nexus.ensighten.com";c.rand=-1;c.currSec=(new Date).getSeconds();c.options={interval:g.interval||100,erLoc:g.errorLocation||c.nexus+"/error/e.gif",scLoc:g.serverComponentLocation||c.nexus+"/"+g.client+"/serverComponent.php",sjPath:g.staticJavascriptPath||
c.nexus+"/"+g.client+"/code/",alLoc:g.alertLocation||c.nexus+"/alerts/a.gif",publishPath:g.publishPath,isPublic:g.isPublic,client:g.client,clientId:g.clientId,enableTagAuditBeacon:g.enableTagAuditBeacon,scUseCacheBuster:g.scUseCacheBuster,beaconSamplingSeedValue:g.beaconSamplingSeedValue||-1};c.ruleList=[];c.allDeploymentIds=[];c.runDeploymentIds=[];c.runRuleIds=[];c.exceptionList=[];c.ensightenVariables={};c.test=function(a){if(!(a.executionData.hasRun||a.executionData.runTime&&0<a.executionData.runTime.length)){for(var d=
0;d<a.dependencies.length;d++)if(!1===a.dependencies[d]())return;a.execute()}};m.prototype=Error();m.prototype||(m.prototype={});m.prototype.constructor=m;c.DependencyNotAvailableException=m;n.prototype=Error();n.prototype||(n.prototype={});n.prototype.constructor=n;c.BeaconException=n;c.checkForInvalidDependencies=function(a,d,e,l){for(a=0;a<e.length;a++)if("DEPENDENCYNEVERAVAILABLE"===e[a])return b.currentRuleId=this.id,b.currentDeploymentId=this.deploymentId,b.reportException(new c.DependencyNotAvailableException(l[a])),
d&&-1!==d&&c.allDeploymentIds.push(d),!0;return!1};b.currentRuleId=-1;b.currentDeploymentId=-1;b.reportedErrors=[];b.reportedAlerts=[];b.AF=[];b._serverTime="";b._clientIP="";b.sampleBeacon=function(){var a=!1;try{var d=(c.currSec||0)%20,b=c.options.beaconSamplingSeedValue;-1===b?a=!0:0!==d&&0===b%d&&(a=!0)}catch(l){}return a};b.getServerComponent=function(a){b.callOnGetServerComponent();b.insertScript(window.location.protocol+"//"+c.options.scLoc,!1,a||!0,c.options.scUseCacheBuster)};b.setVariable=
function(a,b){c.ensightenVariables[a]=b};b.getVariable=function(a){return a in c.ensightenVariables?c.ensightenVariables[a]:null};b.testAll=function(){for(var a=0;a<c.ruleList.length;a++)c.test(c.ruleList[a])};b.executionState={DOMParsed:!1,DOMLoaded:!1,dataDefinitionComplete:!1,conditionalRules:!1,readyForServerComponent:!1};b.reportException=function(a){a.timestamp=(new Date).getTime();c.exceptionList.push(a);a=window.location.protocol+"//"+c.options.erLoc+"?msg="+encodeURIComponent(a.message||
"")+"&lnn="+encodeURIComponent(a.lineNumber||a.line||-1)+"&fn="+encodeURIComponent(a.fileName||"")+"&cid="+encodeURIComponent(c.options.clientId||-1)+"&client="+encodeURIComponent(c.options.client||"")+"&publishPath="+encodeURIComponent(c.options.publishPath||"")+"&rid="+encodeURIComponent(b.currentRuleId||-1)+"&did="+encodeURIComponent(b.currentDeploymentId||-1)+"&errorName="+encodeURIComponent(a.name||"");a=b.imageRequest(a);a.timestamp=(new Date).getTime();this.reportedErrors.push(a)};b.Rule=function(a){this.execute=
function(){this.executionData.runTime.push(new Date);b.currentRuleId=this.id;b.currentDeploymentId=this.deploymentId;try{this.code()}catch(d){window[ensightenOptions.ns].reportException(d)}finally{this.executionData.hasRun=!0,-1!==this.deploymentId&&(c.runDeploymentIds.push(this.deploymentId),c.runRuleIds.push(this.id)),b.testAll()}};this.id=a.id;this.deploymentId=a.deploymentId;this.dependencies=a.dependencies||[];this.code=a.code;this.executionData={hasRun:!1,runTime:[]}};b.registerRule=function(a){if(b.getRule(a.id)&&
-1!==a.id)return!1;c.ruleList.push(a);-1!==a.deploymentId&&c.allDeploymentIds.push(a.deploymentId);b.testAll();return!0};b.getRule=function(a){for(var b=0;b<c.ruleList.length;b++)if(c.ruleList[b].id===a)return c.ruleList[b];return!1};

b.getAllDeploymentIds=function(){return c.allDeploymentIds};b.getRunRuleIds=function(){return c.runRuleIds};b.getRunDeploymentIds=function(){return c.runDeploymentIds};b.hasRuleRun=
function(a){return(a=b.getRule(a))?a.executionData.hasRun:!1};c.toTwoChar=function(a){return(2===a.toString().length?"":"0")+a};b.Alert=function(a){var b=new Date,b=b.getFullYear()+"-"+c.toTwoChar(b.getMonth())+"-"+c.toTwoChar(b.getDate())+" "+c.toTwoChar(b.getHours())+":"+c.toTwoChar(b.getMinutes())+":"+c.toTwoChar(b.getSeconds());this.severity=a.severity||1;this.subject=a.subject||"";this.type=a.type||1;this.ruleId=a.ruleId||-1;this.severity=encodeURIComponent(this.severity);this.date=encodeURIComponent(b);
this.subject=encodeURIComponent(this.subject);this.type=encodeURIComponent(this.type)};b.generateAlert=function(a){a=b.imageRequest(window.location.protocol+"//"+c.options.alLoc+"?d="+a.date+"&su="+a.subject+"&se="+a.severity+"&t="+a.type+"&cid="+c.options.clientId+"&client="+c.options.client+"&publishPath="+c.options.publishPath+"&rid="+b.currentRuleId+"&did="+b.currentDeploymentId);a.timestamp=(new Date).getTime();this.reportedAlerts.push(a)};b.imageRequest=function(a){var b=new Image(0,0);b.src=
a;return b};b.insertScript=function(a,d,e,l){var h,f=document.getElementsByTagName("script");l=void 0!==l?l:!0;if(void 0!==d?d:1)for(h=0;h<f.length;h++)if(f[h].src===a&&f[h].readyState&&/loaded|complete/.test(f[h].readyState))return;if(e){e=1==e&&"object"==typeof b.scDataObj?b.scDataObj:e;c.rand=Math.random()*("1E"+(10*Math.random()).toFixed(0));d=window.location.href;"object"===typeof e&&e.PageID&&(d=e.PageID,delete e.PageID);if("object"===typeof e)for(h in e){h=~d.indexOf("#")?d.slice(d.indexOf("#"),
d.length):"";d=d.slice(0,h.length?d.length-h.length:d.length);d+=~d.indexOf("?")?"&":"?";for(k in e)d+=k+"="+e[k]+"&";d=d.slice(0,-1)+h;break}a+="?";l&&(a+="r="+c.rand+"&");a+="ClientID="+encodeURIComponent(c.options.clientId)+"&PageID="+encodeURIComponent(d)}(function(a,b,d){var e=b.head||b.getElementsByTagName("head");setTimeout(function(){if("item"in e){if(!e[0]){setTimeout(arguments.callee,25);return}e=e[0]}var a=b.createElement("script");a.src=d;a.onload=a.onerror=function(){this.addEventListener&&
(this.readyState="loaded")};e.insertBefore(a,e.firstChild)},0)})(window,document,a)};b.loadScriptCallback=function(a,b,e){var d=document.getElementsByTagName("script"),c;e=d[0];for(c=0;c<d.length;c++)if(d[c].src===a&&d[c].readyState&&/loaded|complete/.test(d[c].readyState))try{b()}catch(f){window[ensightenOptions.ns].reportException(f)}finally{return}d=document.createElement("script");d.type="text/javascript";d.async=!0;d.src=a;d.onerror=function(){this.addEventListener&&(this.readyState="loaded")};
d.onload=d.onreadystatechange=function(){if(!this.readyState||"complete"===this.readyState||"loaded"===this.readyState){this.onload=this.onreadystatechange=null;this.addEventListener&&(this.readyState="loaded");try{b.call(this)}catch(f){window[ensightenOptions.ns].reportException(f)}}};e.parentNode.insertBefore(d,e)};b.unobtrusiveAddEvent=function(a,b,e){try{var d=a[b]?a[b]:function(){};a[b]=function(){e.apply(this,arguments);return d.apply(this,arguments)}}catch(h){window[ensightenOptions.ns].reportException(h)}};
b.anonymous=function(a,d){return function(){try{b.currentRuleId=d?d:"anonymous",a()}catch(e){window[ensightenOptions.ns].reportException(e)}}};b.setCurrentRuleId=function(a){b.currentRuleId=a};b.setCurrentDeploymentId=function(a){b.currentDeploymentId=a};b.bindImmediate=function(a,d,e){if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:e||-1,dependencies:[],code:a});else if("object"!==typeof a)return!1;b.registerRule(a)};b.bindDOMParsed=function(a,d,e){if("function"===typeof a)a=new b.Rule({id:d||
-1,deploymentId:e||-1,dependencies:[function(){return window[ensightenOptions.ns].executionState.DOMParsed}],code:a});else if("object"!==typeof a)return!1;b.registerRule(a)};b.bindDOMLoaded=function(a,d,e){if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:e||-1,dependencies:[function(){return window[ensightenOptions.ns].executionState.DOMLoaded}],code:a});else if("object"!==typeof a)return!1;b.registerRule(a)};b.bindPageSpecificCompletion=function(a,d,e){if("function"===typeof a)a=new b.Rule({id:d||
-1,deploymentId:e||-1,dependencies:[function(){return window[ensightenOptions.ns].executionState.conditionalRules}],code:a});else if("object"!==typeof a)return!1;b.registerRule(a)};b.bindOnGetServerComponent=function(a,d,e){if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:e||-1,dependencies:[function(){return window[ensightenOptions.ns].executionState.readyForServerComponent}],code:a});else if("object"!==typeof a)return!1;b.registerRule(a)};b.bindDataDefinitionComplete=function(a,d,e){if("function"===
typeof a)a=new b.Rule({id:d||-1,deploymentId:e||-1,dependencies:[function(){return window[ensightenOptions.ns].executionState.dataDefinitionComplete}],code:a});else if("object"!==typeof a)return!1;b.registerRule(a)};b.checkHasRun=function(a){if(0===a.length)return!0;for(var d,e=0;e<a.length;++e)if(d=b.getRule(parseInt(a[e],10)),!d||!d.executionData.hasRun)return!1;return!0};b.bindDependencyImmediate=function(a,d,e,l,h){var f=[];if(!c.checkForInvalidDependencies(d,l,e,h)){f.push(function(){return window[ensightenOptions.ns].checkHasRun(e)});
if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:l||-1,dependencies:f,code:a});else if("object"!==typeof a)return!1;b.registerRule(a)}};b.bindDependencyDOMLoaded=function(a,d,e,l,h){var f=[];if(!c.checkForInvalidDependencies(d,l,e,h)){f.push(function(){return window[ensightenOptions.ns].executionState.DOMLoaded});f.push(function(){return window[ensightenOptions.ns].checkHasRun(e)});if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:l||-1,dependencies:f,code:a});else if("object"!==
typeof a)return!1;b.registerRule(a)}};b.bindDependencyDOMParsed=function(a,d,e,l,h){var f=[];if(!c.checkForInvalidDependencies(d,l,e,h)){f.push(function(){return window[ensightenOptions.ns].executionState.DOMParsed});f.push(function(){return window[ensightenOptions.ns].checkHasRun(e)});if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:l||-1,dependencies:f,code:a});else if("object"!==typeof a)return!1;b.registerRule(a)}};b.bindDependencyPageSpecificCompletion=function(a,d,e,l,h){var f=[];
if(!c.checkForInvalidDependencies(d,l,e,h)){f.push(function(){return window[ensightenOptions.ns].executionState.conditionalRules});f.push(function(){return window[ensightenOptions.ns].checkHasRun(e)});if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:l||-1,dependencies:f,code:a});else if("object"!==typeof a)return!1;b.registerRule(a)}};b.bindDependencyOnGetServerComponent=function(a,d,e,l,h){var f=[];if(!c.checkForInvalidDependencies(d,l,e,h)){f.push(function(){return window[ensightenOptions.ns].executionState.readyForServerComponent});
f.push(function(){return window[ensightenOptions.ns].checkHasRun(e)});if("function"===typeof a)a=new b.Rule({id:d||-1,deploymentId:l||-1,dependencies:f,code:a});else if("object"!==typeof a)return!1;b.registerRule(a)}};b.bindDependencyPageSpecificCompletion=function(a,d,e,l,h){var f=[];if(!c.checkForInvalidDependencies(d,l,e,h)){f.push(function(){return window[ensightenOptions.ns].executionState.dataDefinitionComplete});f.push(function(){return window[ensightenOptions.ns].checkHasRun(e)});if("function"===
typeof a)a=new b.Rule({id:d||-1,deploymentId:l||-1,dependencies:f,code:a});else if("object"!==typeof a)return!1;b.registerRule(a)}};b.dataDefintionIds=[];b.dataDefinitions=[];b.pageSpecificDataDefinitionsSet=!1;b.setPageSpecificDataDefinitionIds=function(a){for(var d=a.length,e=0;e<d;e++){var c=a[e];if(Array.prototype.indexOf)-1==b.dataDefinitionIds.indexOf(c)&&b.dataDefinitionIds.push(c);else{for(var h=!1,f=b.dataDefinitionIds.length,g=0;g<f;g++)if(b.dataDefinitionIds[g]===c){h=!0;break}h||b.dataDefinitionIds.push(c)}}b.pageSpecificDataDefinitionsSet=
!0;p()};b.DataDefinition=function(a,b){this.id=a;this.registrationFn=b;this.endRegistrationTime=this.startRegistrationTime=null;this.startRegistration=function(){this.startRegistrationTime=new Date};this.endRegistration=function(){this.endRegistrationTime=new Date}};b.registerDataDefinition=function(a,d){var e=b.dataDefinitions[d];e||(e=new b.DataDefinition(d,a),b.dataDefinitions[d]=e);e.startRegistrationTime||(e.startRegistration(),e.registrationFn(),e.endRegistration());b.pageSpecificDataDefinitionsSet&&
p()};b.callOnDataDefintionComplete=function(){b.executionState.dataDefinitionComplete=!0;b.testAll()};b.callOnDOMParsed=function(){window[ensightenOptions.ns].executionState.DOMParsed=!0;window[ensightenOptions.ns].testAll()};b.callOnDOMLoaded=function(){window[ensightenOptions.ns].executionState.DOMParsed=!0;window[ensightenOptions.ns].executionState.DOMLoaded=!0;window[ensightenOptions.ns].testAll()};b.callOnPageSpecificCompletion=function(){for(var a=document.getElementsByTagName("script"),b=0,
e=a.length;b<e;b++)if(a[b].src&&a[b].src.match(/\.ensighten\.com\/(.+?)\/code\/.*/i)&&"loaded"!=a[b].readyState&&"complete"!=a[b].readyState){setTimeout(window[ensightenOptions.ns].callOnPageSpecificCompletion,50);return}setTimeout(function(){window[ensightenOptions.ns].executionState.conditionalRules=!0;window[ensightenOptions.ns].testAll()},1)};b.callOnGetServerComponent=function(){window[ensightenOptions.ns].executionState.readyForServerComponent=!0;window[ensightenOptions.ns].testAll()};b.hasDOMParsed=
function(){return window[ensightenOptions.ns].executionState.DOMParsed};b.hasDOMLoaded=function(){return window[ensightenOptions.ns].executionState.DOMLoaded};b.hasPageSpecificCompletion=function(){return window[ensightenOptions.ns].executionState.conditionalRules};var r=function(){var a=[],b=!1,e=!1;return{add:function(d){b&&!e?d():"function"==typeof d&&(a[a.length]=d)},exec:function(){e=!0;do{var d=a;a=[];b=!0;for(var c=0;c<d.length;c++)try{d[c].call(window)}catch(f){window[ensightenOptions.ns].reportException(f)}}while(0<
a.length);e=!1},haveRun:function(){return b}}};b.new_fArray=function(){return r()};c.timer=null;(function(){function a(a,b){return function(){a.apply(b,arguments)}}window.console||(window.console={});var b=window.console;if(!b.log)if(window.log4javascript){var c=log4javascript.getDefaultLogger();b.log=a(c.info,c);b.debug=a(c.debug,c);b.info=a(c.info,c);b.warn=a(c.warn,c);b.error=a(c.error,c)}else b.log=function(){};b.debug||(b.debug=b.log);b.info||(b.info=b.log);b.warn||(b.warn=b.log);b.error||(b.error=
b.log)})();document.addEventListener?(-1<navigator.userAgent.indexOf("AppleWebKit/")?c.timer=window.setInterval(function(){/loaded|interactive|complete/.test(document.readyState)&&(clearInterval(c.timer),b.callOnDOMParsed())},50):document.addEventListener("DOMContentLoaded",b.callOnDOMParsed,!1),window.addEventListener("load",b.callOnDOMLoaded,!1)):(setTimeout(function(){var a=window.document;(function(){try{if(!document.body)throw"continue";a.documentElement.doScroll("left")}catch(d){setTimeout(arguments.callee,
15);return}window[ensightenOptions.ns].callOnDOMParsed()})()},1),window.attachEvent("onload",function(){window[ensightenOptions.ns].callOnDOMLoaded()}));"true"===c.options.enableTagAuditBeacon&&b.sampleBeacon()&&window.setTimeout(function(){if(window[ensightenOptions.ns]&&!window[ensightenOptions.ns].mobilePlatform)try{for(var a=[],d,e,l,h,f=0;f<c.ruleList.length;++f)e=c.ruleList[f],l=e.executionData.hasRun?"1":"0",h=e.deploymentId.toString()+"|"+e.id.toString()+"|"+l,a.push(h);d="["+a.join(";")+
"]";var m=window.location.protocol+"//"+c.nexus+"/"+encodeURIComponent(g.client)+"/"+encodeURIComponent(g.publishPath)+"/TagAuditBeacon.rnc?cid="+encodeURIComponent(g.clientId)+"&data="+d+"&idx=0&r="+c.rand;b.imageRequest(m)}catch(q){b.currentRuleId=-1,b.currentDeploymentId=-1,a=new c.BeaconException(q),window[ensightenOptions.ns].reportException(a)}},3E3);window.setInterval(b.testAll,c.options.interval);return b}(ensightenOptions),"true"===ensightenOptions.enablePagePerfBeacon&&window[ensightenOptions.ns]&&
window[ensightenOptions.ns].sampleBeacon()&&window[ensightenOptions.ns].bindDOMParsed(function(){if(!window[ensightenOptions.ns].mobilePlatform){var g=window.performance;if(g){var g=g.timing||{},m=g.navigationStart||0,n={connectEnd:"ce",connectStart:"cs",domComplete:"dc",domContentLoadedEventEnd:"dclee",domContentLoadedEventStart:"dcles",domInteractive:"di",domLoading:"dl",domainLookupEnd:"dle",domainLookupStart:"dls",fetchStart:"fs",loadEventEnd:"lee",loadEventStart:"les",redirectEnd:"rede",redirectStart:"reds",
requestStart:"reqs",responseStart:"resps",responseEnd:"respe",secureConnectionStart:"scs",unloadEventStart:"ues",unloadEventEnd:"uee"};var p="&ns="+encodeURIComponent(g.navigationStart);for(var c in n)if(void 0!==g[c]){var b=g[c]-m;p+="&"+n[c]+"="+(0<b?encodeURIComponent(b):0)}else p+="&"+n[c]+"=-1";window[ensightenOptions.ns].timing=p;c=ensightenOptions.nexus||"nexus.ensighten.com";g=ensightenOptions.staticJavascriptPath||"";p=g.indexOf(".com/");m=g.indexOf("/code/");g=g.substring(p+4,m)+"/perf.rnc";
g+="?cid="+encodeURIComponent(ensightenOptions.clientId)+window[ensightenOptions.ns].timing;window[ensightenOptions.ns].imageRequest("//"+c+g)}}}));
		
window[ensightenOptions.ns].ensEvent||(window[ensightenOptions.ns].ensEvent=function(q,w){var h={queue:{},pollQueue:{},pushTrigger:function(a,c){if("[object Array]"===Object.prototype.toString.call(a)){for(var g=0;g<a.length;g++)h.pushTrigger(a[g],c);return!0}if("string"!=typeof a)return!1;this.queue[a]=this.queue[a]||{fn:[]};"function"==typeof c&&this.queue[a].fn.push(c);return!0},callTrigger:function(a,c,g){if("string"!=typeof a)return!1;a=h.queue[a];if("object"==typeof a&&a.fn&&a.fn.length&&(0!=
a.fireOnFirstSet&&c==w||c!=w&&0!=a.fireOnUpdate))for(c=0;c<a.fn.length;c++)a.fn[c].call(this)},setPollOptions:function(a,c,g){this.queue[a]=this.queue[a]||{fn:[]};this.queue[a].fireOnFirstSet=c;this.queue[a].fireOnUpdate=g},callPoll:function(a,c,g,q,r){if("string"==typeof a&&c&&c.length&&!(1>c.length)){for(var n=0;n<c.length;n++)h.setPollOptions(c[n],q,r);h.pushWatch(a,c,g)}},pushWatch:function(a,c,g){this.pollQueue[a]||(this.pollQueue[a]={previousVal:w,eventArr:[],valueFn:g});this.pollQueue[a].eventArr=
this.pollQueue[a].eventArr.concat(c);this.pollQueue[a].valueFn=g},globalWatch:function(){setInterval(function(){for(var a in h.pollQueue){var c=h.pollQueue[a],g=c.valueFn(a);if(c.previousVal!==g){for(var n=0;n<c.eventArr.length;n++)h.callTrigger.call(q,c.eventArr[n],c.previousVal,g);h.pollQueue[a].previousVal=g}}},500)}};h.globalWatch();return{add:function(a,c){return h.pushTrigger(a,c)},get:function(a){return h.queue[a]},trigger:function(a,c){return h.callTrigger.call(c||q,a)},poll:function(a,c,
g,n,r){r=r||q[ensightenOptions.ns].data.resolve;return h.callPoll(a,c,r,g,n)}}}(window),function(q,w,h){w[q]=h()}("qwery",window[ensightenOptions.ns],function(){function q(){this.c={}}function w(b){return H.g(b)||H.s(b,"(^|\\s+)"+b+"(\\s+|$)",1)}function h(b,d){for(var e=0,f=b.length;e<f;e++)d(b[e])}function a(b){for(var d=[],e=0,f=b.length;e<f;++e)k(b[e])?d=d.concat(b[e]):d[d.length]=b[e];return d}function c(b){for(var d=0,e=b.length,f=[];d<e;d++)f[d]=b[d];return f}function g(b){for(;(b=b.previousSibling)&&
1!=b.nodeType;);return b}function n(b,d,e,f,a,l,k,c,g,h,t){var I,B,m;if(1!==this.nodeType||d&&"*"!==d&&this.tagName&&this.tagName.toLowerCase()!==d||e&&(I=e.match(Q))&&I[1]!==this.id)return!1;if(e&&(m=e.match(R)))for(b=m.length;b--;)if(!w(m[b].slice(1)).test(this.className))return!1;if(g&&u.pseudos[g]&&!u.pseudos[g](this,t))return!1;if(f&&!k)for(B in g=this.attributes,g)if(Object.prototype.hasOwnProperty.call(g,B)&&(g[B].name||B)==a)return this;return f&&!y(l,S(this,a)||"",k)?!1:this}function r(b){return J.g(b)||
J.s(b,b.replace(T,"\\$1"))}function y(b,d,e){switch(b){case "=":return d==e;case "^=":return d.match(x.g("^="+e)||x.s("^="+e,"^"+r(e),1));case "$=":return d.match(x.g("$="+e)||x.s("$="+e,r(e)+"$",1));case "*=":return d.match(x.g(e)||x.s(e,r(e),1));case "~=":return d.match(x.g("~="+e)||x.s("~="+e,"(?:^|\\s+)"+r(e)+"(?:\\s+|$)",1));case "|=":return d.match(x.g("|="+e)||x.s("|="+e,"^"+r(e)+"(-|$)",1))}return 0}function p(b,d){var e=[],f=[],a,l,k,c,g,m=d,t=C.g(b)||C.s(b,b.split(K)),u=b.match(L);if(!t.length)return e;
l=(t=t.slice(0)).pop();t.length&&(a=t[t.length-1].match(M))&&(m=N(d,a[1]));if(!m)return e;c=l.match(E);k=m!==d&&9!==m.nodeType&&u&&/^[+~]$/.test(u[u.length-1])?function(b){for(;m=m.nextSibling;)1==m.nodeType&&(c[1]?c[1]==m.tagName.toLowerCase():1)&&(b[b.length]=m);return b}([]):m.getElementsByTagName(c[1]||"*");a=0;for(l=k.length;a<l;a++)if(g=n.apply(k[a],c))e[e.length]=g;if(!t.length)return e;h(e,function(b){v(b,t,u)&&(f[f.length]=b)});return f}function v(b,d,e,a){function l(b,a,c){for(;c=U[e[a]](c,
b);)if(f(c)&&n.apply(c,d[a].match(E)))if(a){if(k=l(c,a-1,c))return k}else return c}var k;return(k=l(b,d.length-1,b))&&(!a||z(k,a))}function f(b,d){return b&&"object"===typeof b&&(d=b.nodeType)&&(1==d||9==d)}function l(b){var d=[],e,f;e=0;a:for(;e<b.length;++e){for(f=0;f<d.length;++f)if(d[f]==b[e])continue a;d[d.length]=b[e]}return d}function k(b){return"object"===typeof b&&isFinite(b.length)}function N(b,d,e){return 9===b.nodeType?b.getElementById(d):b.ownerDocument&&((e=b.ownerDocument.getElementById(d))&&
z(e,b)&&e||!z(b,b.ownerDocument)&&F('[id="'+d+'"]',b)[0])}function u(b,d){var e,l,g;g=d?"string"==typeof d?u(d)[0]:!d.nodeType&&k(d)?d[0]:d:m;if(!g||!b)return[];if(b===window||f(b))return!d||b!==window&&f(g)&&z(b,g)?[b]:[];if(b&&k(b))return a(b);if(e=b.match(V)){if(e[1])return(l=N(g,e[1]))?[l]:[];if(e[2])return c(g.getElementsByTagName(e[2]));if(W&&e[3])return c(g.getElementsByClassName(e[3]))}return F(b,g)}function t(b,d){return function(e){var f,a;O.test(e)?9!==b.nodeType&&((a=f=b.getAttribute("id"))||
b.setAttribute("id",a="__qwerymeupscotty"),d(b.parentNode||b,'[id="'+a+'"]'+e,!0),f||b.removeAttribute("id")):e.length&&d(b,e,!1)}}var m=document,D=m.documentElement,F,Q=/#([\w\-]+)/,R=/\.[\w\-]+/g,M=/^#([\w\-]+)$/,X=/^([\w]+)?\.([\w\-]+)$/,O=/(^|,)\s*[>~+]/,Y=/^\s+|\s*([,\s\+\~>]|$)\s*/g,A=/[\s\>\+\~]/,P=/(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/,T=/([.*+?\^=!:${}()|\[\]\/\\])/g,V=new RegExp(M.source+"|"+/^([\w\-]+)$/.source+"|"+/^\.([\w\-]+)$/.source),L=new RegExp("("+A.source+
")"+P.source,"g"),K=new RegExp(A.source+P.source),E=new RegExp(/^(\*|[a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/.source+"("+/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/.source+")?("+/:([\w\-]+)(\(['"]?([^()]+)['"]?\))?/.source+")?"),U={" ":function(b){return b&&b!==D&&b.parentNode},">":function(b,d){return b&&b.parentNode==d.parentNode&&b.parentNode},"~":function(b){return b&&b.previousSibling},"+":function(b,d,e,f){return b?(e=g(b))&&(f=g(d))&&e==f&&e:!1}};
q.prototype={g:function(b){return this.c[b]||void 0},s:function(b,d,e){d=e?new RegExp(d):d;return this.c[b]=d}};var H=new q,J=new q,x=new q,C=new q,z="compareDocumentPosition"in D?function(b,d){return 16==(d.compareDocumentPosition(b)&16)}:"contains"in D?function(b,d){d=9===d.nodeType||d==window?D:d;return d!==b&&d.contains(b)}:function(b,d){for(;b=b.parentNode;)if(b===d)return 1;return 0},S=function(){var b=m.createElement("p");return(b.innerHTML='<a href="#x">x</a>',"#x"!=b.firstChild.getAttribute("href"))?
function(b,e){return"class"===e?b.className:"href"===e||"src"===e?b.getAttribute(e,2):b.getAttribute(e)}:function(b,e){return b.getAttribute(e)}}(),W=!!m.getElementsByClassName,Z=m.querySelector&&m.querySelectorAll,aa=function(b,d){var e=[],f,a;try{if(9===d.nodeType||!O.test(b))return c(d.querySelectorAll(b));h(f=b.split(","),t(d,function(b,d){a=b.querySelectorAll(d);1==a.length?e[e.length]=a.item(0):a.length&&(e=e.concat(c(a)))}));return 1<f.length&&1<e.length?l(e):e}catch(ba){}return G(b,d)},G=
function(b,d){var e=[],f,a,c,k;b=b.replace(Y,"$1");if(f=b.match(X)){k=w(f[2]);f=d.getElementsByTagName(f[1]||"*");a=0;for(c=f.length;a<c;a++)k.test(f[a].className)&&(e[e.length]=f[a]);return e}h(f=b.split(","),t(d,function(b,f,l){k=p(f,b);a=0;for(c=k.length;a<c;a++)if(9===b.nodeType||l||z(k[a],d))e[e.length]=k[a]}));return 1<f.length&&1<e.length?l(e):e},A=function(b){"undefined"!==typeof b.useNativeQSA&&(F=b.useNativeQSA?Z?aa:G:G)};A({useNativeQSA:!0});u.configure=A;u.uniq=l;u.is=function(b,d,e){if(f(d))return b==
d;if(k(d))return!!~a(d).indexOf(b);for(var l=d.split(","),c;d=l.pop();)if(c=C.g(d)||C.s(d,d.split(K)),d=d.match(L),c=c.slice(0),n.apply(b,c.pop().match(E))&&(!c.length||v(b,c,d,e)))return!0;return!1};u.pseudos={};return u}),function(){function q(f,a,c){var l;n||(n=window[ensightenOptions.ns].qwery);l=n;if((l=l.call(c,a,c))&&0<l.length){if("_root"==a)f=c;else if(f===c)f=void 0;else{b:{for(var k=l.length,g=0;g<k;g++)if(f===l[g]){l=!0;break b}l=!1}l||(f.parentNode?(r++,f=q(f.parentNode,a,c)):f=void 0)}return f}return!1}
function w(f,a,c,g){p[f.id]||(p[f.id]={});p[f.id][a]||(p[f.id][a]={});p[f.id][a][c]||(p[f.id][a][c]=[]);p[f.id][a][c].push(g)}function h(a,c,g,h){if(h||g)if(h)for(var f=0;f<p[a.id][c][g].length;f++){if(p[a.id][c][g][f]===h){p[a.id][c][g].pop(f,1);break}}else delete p[a.id][c][g];else p[a.id][c]={}}function a(a,c,k){if(p[a][k]){var f=c.target||c.srcElement,l,h,m={},n=h=0;r=0;for(l in p[a][k])p[a][k].hasOwnProperty(l)&&(h=q(f,l,v[a].element))&&g.matchesEvent(k,v[a].element,h,"_root"==l,c)&&(r++,p[a][k][l].match=
h,m[r]=p[a][k][l]);c.stopPropagation=function(){c.cancelBubble=!0};for(h=0;h<=r;h++)if(m[h])for(n=0;n<m[h].length;n++){if(!1===m[h][n].call(m[h].match,c)){g.cancel(c);return}if(c.cancelBubble)return}}}function c(f,c,k,n){function l(c){return function(f){a(t,f,c)}}f instanceof Array||(f=[f]);k||"function"!=typeof c||(k=c,c="_root");var t=this.id,m;for(m=0;m<f.length;m++)p[t]&&p[t][f[m]]||g.addEvent(this,f[m],l(f[m])),n?h(this,f[m],c,k):w(this,f[m],c,k);return this}function g(a,c,k,h){if("string"==
typeof a&&"function"==typeof c||"string"==typeof c)g(document).on(a,c,k,h||!1);if(!(this instanceof g)){for(var f in v)if(v[f].element===a)return v[f];y++;v[y]=new g(a,y);v[y]._on=v[y].on;v[y].on=function(a,c,f,g){var h="function"==typeof c?c:f;if("function"==typeof c?f:g)a=[a],"string"==typeof c&&a.push(c),a.push(function(a){return function(c){c.defaultPrevented||window[ensightenOptions.ns].Delegate.load(this);if(this.nodeName&&"a"!=this.nodeName.toLowerCase())return a.call(this);"undefined"!=typeof c.preventDefault?
c.preventDefault():c.returnValue=!1;a.call(this)}}(h)),this._on.apply(this,a);else return this._on.call(this,a,c,f)};return v[y]}this.element=a;this.id=c}var n,r=0,y=0,p={},v={};g.prototype.on=function(a,g,h){return c.call(this,a,g,h)};g.prototype.off=function(a,g,h){return c.call(this,a,g,h,!0)};g.cancel=function(a){a.preventDefault();a.stopPropagation()};g.addEvent=function(a,c,g){a.element.addEventListener(c,g,"blur"==c||"focus"==c)};g.matchesEvent=function(){return!0};g.load=function(a){setTimeout(function(a,
c){return function(){if(a.nodeName&&"a"==a.nodeName.toLowerCase()){if(c&&/^javascript\s*\:/.test(c))return(new Function(unescape(c))).call(window);c&&(window.location.href=c)}}}(a,a.href||""),750)};window[ensightenOptions.ns].Delegate=g}(),function(q){var w=q.addEvent;q.addEvent=function(h,a,c){if(h.element.addEventListener)return w(h,a,c);"focus"==a&&(a="focusin");"blur"==a&&(a="focusout");h.element.attachEvent("on"+a,c)};q.cancel=function(h){h.preventDefault&&h.preventDefault();h.stopPropagation&&
h.stopPropagation();h.returnValue=!1;h.cancelBubble=!0}}(window[ensightenOptions.ns].Delegate),window[ensightenOptions.ns].on=window[ensightenOptions.ns].Delegate);Bootstrapper.dataDefinitionIds = [];Bootstrapper.bindImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;(function(lib,win,doc,console,bootStrapper){lib(doc).on("edl-ready",function(){if(console){console.log({type:"info",message:"edl-ready triggered.",data:bootStrapper.dataManager.getData("digitalData")});if(win.dataLayer)win.dataLayer.utilities.dataCollect(bootStrapper.dataManager.getData("digitalData"))}})})(jQuery,window,document,console,Bootstrapper)},1446537,328461);
Bootstrapper.bindImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;Bootstrapper.dataManager=function(){var _private={data:{},add:function(o){if(typeof o=="object"&&o.id){o.get=function(e){return Bootstrapper.dataManager.getDataElement(this.id,e)};this.data[o.id]=o}},getObj:function(i){if(i)return _private.data[i];return _private.data},getDataElement:function(i,e){if(typeof this.data[i]=="undefined")return"";var dataObj=this.data[i].data,
retVal;if(typeof dataObj=="object"){if(typeof dataObj[e]=="undefined")return"";dataObj=dataObj[e];if(typeof dataObj.get=="string"){var d=eval(dataObj.get);if(typeof dataObj.mod=="string"&&dataObj.mod!==""){var m="(function(){ return "+(dataObj.mod===""?"this":dataObj.mod)+";})";retVal=eval(m).call(d)}else if(typeof dataObj.mod=="function")retVal=dataObj.mod.call(d,d);else retVal=d}else if(typeof dataObj.get=="function"){var d=dataObj.get.call(this.data[i]);if(typeof dataObj.mod=="string"&&dataObj.mod!==
""){var m="(function(){ return "+(dataObj.mod===""?"this":dataObj.mod)+";})";retVal=eval(m).call(d)}else if(typeof dataObj.mod=="function")retVal=dataObj.mod.call(d,d);else retVal=d}return retVal}},getDataLayer:function(i){var retObj={};var dataObj=this.data[i].data;for(key in dataObj)try{retObj[key]=this.getDataElement(i,key)}catch(e){retObj[key]=null}return retObj},getAllData:function(){var data=this.data,retObj={_d:{}};for(var key in data){retObj._d[key]={};var d=this.getDataLayer(key);for(var k in d){retObj[k]=
d[k];retObj._d[key][k]=d[k]}}return retObj},getData:function(i){if(i)return this.getDataLayer(i);else return this.getAllData()},addDataElement:function(layerId,name,o){if(typeof this.data[layerId]=="object"&&typeof name=="string"&&typeof o=="object"){var d=this.data[layerId];d.data[name]=o}}},_public={push:function(dl){_private.add(dl)},getObj:function(i){return _private.getObj(i)},getData:function(i){return _private.getData(i)},getDataElement:function(i,e){return _private.getDataElement(i,e)},addDataElement:function(layerId,
name,o){return _private.addDataElement(layerId,name,o)}};return _public}();Bootstrapper.dataManager.map=function(){return{define:function(n,d){if(Bootstrapper.data)for(i in d){var v=typeof d[i]=="string"?Bootstrapper.data.extract(d[i]):d[i]();Bootstrapper.data.dataManagerPush(i,v,n)}}}}();window.$data=function(a,b){if(typeof b=="string")try{return Bootstrapper.dataManager.getDataElement(a,b)}catch(e){}else if(typeof a=="string")return Bootstrapper.dataManager.getData()[a]||"";return""};Bootstrapper.bindOnGetServerComponent(function(){var DL=
Bootstrapper.dataManager&&Bootstrapper.targetingExtension?Bootstrapper.dataManager.getData():{};if(~document.cookie.indexOf("VTP:enabled"))DL["ensightenVT"]=1;if(Bootstrapper.scDataObj)for(i in DL)Bootstrapper.scDataObj[i]=DL[i]});var ns=window[ensightenOptions.ns];ns.VTconfig=ns.VTconfig||{};ns.VTconfig["DM"]=this.deploymentId;Bootstrapper.dataManager.pushObject=function(obj,id,name){Bootstrapper.dataManager.push({name:name||id,id:id,data:{}});for(var k in obj)if(obj[k]&&typeof obj[k]!=="function")Bootstrapper.dataManager.addDataElement(id,
k,{name:k,get:function(o,key){return function(){return o[key]}}(obj,k)})}},1446535,328447);Bootstrapper.bindDependencyImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;(function(lib,doc,console,bootStrapper){lib(doc).on("edl-ready",function(){Bootstrapper.pulse.collect();Bootstrapper.pulse.track()})})(jQuery,document,console,Bootstrapper)},1446536,[1983636],301206,[299309]);
Bootstrapper.bindDependencyImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;(function(win,doc,console,lib,bootStrapper,pulse,jrain,cookieHelper,lodash){win.dataLayer=win.dataLayer||{};win.dataLayer.utilities={transformations:{toLowerCase:function(value){return typeof value==="string"?value.toLowerCase():value},trim:function(value){return typeof value==="string"?value.trim():value}},logMessage:function(message){var loggedObject={};if(console&&
message){if(message.message)loggedObject.message=message.message;if(message.data)loggedObject.data=message.data;if(message.type==="error"&&console.error)console.error(loggedObject);else if(console.log)console.log(loggedObject)}},autoMap:function(mappings,sourceObject,destinationObject){if(!mappings||!mappings.length||!sourceObject||!destinationObject)return;lodash.forEach(mappings,function(mapping){var srcValue;if(!mapping||!mapping.srcPath||!mapping.destPath)return true;srcValue=lodash.result(sourceObject,
mapping.srcPath);if(srcValue!==undefined){if(!mapping.transformations||!mapping.transformations.length)mapping.transformations=[win.dataLayer.utilities.transformations.trim];lodash.forEach(mapping.transformations,function(transformation){if(transformation&&typeof transformation==="function")srcValue=transformation(srcValue);if(srcValue===undefined)return true});lodash.set(destinationObject,mapping.destPath,srcValue)}})},supportsLocalStorage:function(localStorage){var text="text";try{localStorage.setItem(text,
text);localStorage.removeItem(text);return true}catch(e){return false}}(win.localStorage),mergeCollection:function(collection1,collection2,fnDistinct){var mergedCollection=lodash.union(collection1,collection2);return fnDistinct?lodash.uniq(mergedCollection,false,fnDistinct):mergedCollection},safeJSONParse:function(value){if(value&&typeof value==="string")try{return JSON.parse(value)}catch(e){return null}},deleteFromArray:function(array,valueToBeDeleted){var i=0;if(!array||!array.length||!array.splice)return array;
for(i=0;i<array.length;i++)if(array[i]===valueToBeDeleted){array.splice(i,1);i--}return array},startsWith:function(value,prefix){return value&&prefix?value.indexOf(prefix)===0:false},endsWith:function(value,suffix){return value&&suffix?value.indexOf(suffix,value.length-suffix.length)!==-1:false},arrayToObject:function(arr){var result,counter=0;if(arr&&arr.length){result={};lib(arr).each(function(index,value){var key;if(index%2){key=arr[index-1];if(key&&typeof key==="string")result[key.toLowerCase()]=
arr[index]}})}return result},objectToArray:function(obj){var result=[];if(obj)for(var key in obj)if(obj.hasOwnProperty(key)){result.push(key);result.push(obj[key])}return result.length?result:null},watch:function(obj,propertyPath,callback,value,exitIfObjIsEmpty,checkIntervalInMs,maxAttempts){var counter=0,interval;if(!lodash.isFunction(callback))return null;if(!propertyPath||exitIfObjIsEmpty&&!obj)return callback();checkIntervalInMs=checkIntervalInMs||100;maxAttempts=maxAttempts||100;interval=setInterval(function(){var propertyValue=
lodash.result(obj,propertyPath);if(obj&&value===undefined&&propertyValue||propertyValue===value||counter>=maxAttempts){clearInterval(interval);return callback()}counter++},checkIntervalInMs)},getSession:function(){var key="analyticsSession",currentDate=Date.now(),duration=18E5,analyticsSessionObject=win.dataLayer.utilities.safeJSONParse(cookieHelper(key));if(!analyticsSessionObject||analyticsSessionObject.lastVisitedDate&&currentDate>=analyticsSessionObject.lastVisitedDate+duration)analyticsSessionObject=
{createdDate:currentDate,ID:Math.random().toString(36).substr(2)+"."+currentDate,status:!analyticsSessionObject?"new":"renewed"};else analyticsSessionObject.status="existing";analyticsSessionObject.lastVisitedDate=currentDate;cookieHelper(key,JSON.stringify(analyticsSessionObject));return win.dataLayer.utilities.safeJSONParse(cookieHelper(key))},getJSession:function(){return{jsessionId:cookieHelper("sessionUUID")}},dataCollect:function(input,extraData,dataType){var currentDate,data,config={url:"https://threads.tapestrykpi.com/datacollect",
httpMethod:"POST"};if(!input)return;data=lodash.cloneDeep(input);if(extraData)data=lodash.merge(data,extraData);currentDate=new Date;data.createdDate=currentDate.getTime();if(currentDate.getTimezoneOffset)data.timezoneOffset=currentDate.getTimezoneOffset();data.type=dataType||"page.load"},getQueryParameters:function(str){var result={},params;str=str||doc.location.search;if(!str)return;params=str.replace(/(^\?)/,"").split("\x26");lodash.forEach(params,function(param){param=param.split("\x3d");try{result[param[0]]=
win.decodeURIComponent(win.encodeURIComponent(param[1]||""))}catch(err){result[param[0]]=""}});return result},components:function(){var elementType="",eleAttribute="impressionRegister",clickAttribute="data-object-id",maxColumns=3,metadataLookup={contentTypes:{ec:"Editoral Content",tv:"Trivia",po:"Poll",vi:"Video",sm:"Social Module",sw:"Sweeps",ig:"Image Gallery"},interests:{mu:"Music",sp:"Sports",ga:"Games",tr:"Travel",dg:"Doing Good",tre:"Trending",fb:"Fashion \x26 Beauty",fd:"Food \x26 Drinks",
me:"Movies \x26 Entertainment",te:"Technology",ff:"Family \x26 Friends",hw:"Health \x26 Wellness"},partners:{mcr:"MCR",spr:"Sprite",swa:"Southwest Airlines",ptr:"partner",cst:"customer",dom:"dominos",pwr:"powerade",vit:"vitamin water",dko:"diet coke"},activities:{sw:"Sweepstakes",pr:"Promotion",re:"Redemption",sl:"Slider",sh:"Share",tw:"Tug of War",vo:"Vote",twt:"Tweet",po:"Post",st:"Status",tv:"Tweet to Vote"},brandInterests:{co:"Coke",sp:"Sprite",dc:"Diet Coke",mm:"Minute Maid",mp:"Mr. Pibb",my:"Mello Yellow",
po:"Powerade",fr:"Fresca",ds:"Dasani",tb:"Tab",se:"Seagrams",fa:"Fanta",cz:"Coke Zero",bq:"Barqs",fz:"Fuze"}};function getTotalColumns(){var windowSize=win.componentGlobalVars&&win.componentGlobalVars.windowSize,totalColumns=maxColumns;if(windowSize){if(windowSize==="mobile")totalColumns=1;if(windowSize==="tablet")totalColumns=2}return totalColumns}function getEmptyComponentsPositionMatrix(totalColumns,maxTotalRows){var componentsPositionMatrix={},i=1,j=1;do{j=1;do{componentsPositionMatrix[i]=componentsPositionMatrix[i]||
{};componentsPositionMatrix[i][j]=-1;j++}while(j<=totalColumns);i++}while(i<=maxTotalRows);return componentsPositionMatrix}function getNextAvailableMatrixCellPosition(componentsPositionMatrix){var i=1,j;if(componentsPositionMatrix){do{j=1;do{if(componentsPositionMatrix[i][j]===-1)return{row:i,col:j};j++}while(componentsPositionMatrix[i][j]);i++}while(componentsPositionMatrix[i])}}function updateComponentsPosition(componentsMetadata){var totalColumns=getTotalColumns(),maxTotalRows=lib(elementType+
"["+eleAttribute+"]").length*maxColumns,componentsPositionMatrix=getEmptyComponentsPositionMatrix(totalColumns,maxTotalRows);if(!componentsMetadata||!componentsMetadata.length)return componentsMetadata;lib(componentsMetadata).each(function(index,componentMetadata){var nextAvailableMatrixCellPosition=getNextAvailableMatrixCellPosition(componentsPositionMatrix),startRow,startCol,position="";if(nextAvailableMatrixCellPosition){startRow=nextAvailableMatrixCellPosition.row;startCol=nextAvailableMatrixCellPosition.col;
do{nextAvailableMatrixCellPosition.col=startCol;do{position+=(nextAvailableMatrixCellPosition.row-1)*totalColumns+nextAvailableMatrixCellPosition.col+"-";componentsPositionMatrix[nextAvailableMatrixCellPosition.row][nextAvailableMatrixCellPosition.col]=componentMetadata.componentInfo.componentID;nextAvailableMatrixCellPosition.col++}while(nextAvailableMatrixCellPosition.col-startCol<componentMetadata.attributes.col);nextAvailableMatrixCellPosition.row++}while(nextAvailableMatrixCellPosition.row-startRow<
componentMetadata.attributes.row)}if(position)componentMetadata.attributes.position=position.slice(0,-1);delete componentMetadata.attributes.row;delete componentMetadata.attributes.col});return componentsMetadata}function getComponentSize(element){var row=1,col=0,elementCss=lib(element).attr("class"),elementCssArray=elementCss?elementCss.split(" "):undefined;if(elementCssArray){row=elementCssArray.indexOf("tall")>-1?2:1;if(elementCssArray.indexOf("small")>-1)col=1;if(elementCssArray.indexOf("medium")>
-1)col=2;if(elementCssArray.indexOf("large")>-1)col=3}return{row:row,col:col||getTotalColumns()}}function getComponentsMetadataObject(metadataString){var seperator="-",itemCount=5,metadataArray=(metadataString||"").split(seperator),invalidData="na",invalidComponentMetadata={componentInfo:{componentID:invalidData},category:{primaryCategory:invalidData,subCategory:invalidData,componentType:invalidData},attributes:{brandInterest:invalidData,ownedBy:invalidData,assetID:metadataString}};return metadataArray.length===
itemCount?{componentInfo:{componentID:metadataString},category:{primaryCategory:metadataLookup.interests[metadataArray[1]]||invalidComponentMetadata.category.primaryCategory,subCategory:metadataLookup.activities[metadataArray[3]]||invalidComponentMetadata.category.subCategory,componentType:metadataLookup.contentTypes[metadataArray[0]]||invalidComponentMetadata.category.componentType},attributes:{brandInterest:metadataLookup.brandInterests[metadataArray[4]]||invalidComponentMetadata.attributes.brandInterest,
ownedBy:metadataLookup.partners[metadataArray[2]]||invalidComponentMetadata.attributes.ownedBy,assetID:metadataString}}:invalidComponentMetadata}function getComponentSource(element){var src="";lib(element).find("iframe").each(function(index,el){var ifid=lib(el).attr("id")||"",ifsrc=lib(el).attr("src")||"";if(ifsrc.indexOf("massrel.io")>=0||ifid.indexOf("mr-iframe")>=0)src+="spredfast";var eid=lib(el).attr("id")||"",vhash=lib(el).attr("data-video-hash")||"",vid=lib(el).attr("data-video-id")||"";if(src.indexOf("youtube.com")<
0&&(vhash!=""||vid!=""))src+=src.length>0?",youtube.com":"youtube.com"});lib(element).find("["+clickAttribute+"]").each(function(index,el){var eid=lib(el).attr("id")||"",vhash=lib(el).attr("data-video-hash")||"",vid=lib(el).attr("data-video-id")||"";if(src.indexOf("youtube.com")<0&&(vhash!=""||vid!=""))src+=src.length>0?",youtube.com":"youtube.com";else if(src.indexOf("cq5")<0)src+=src.length>0?",cq5":"cq5"});return src===""?"unspecified":src}return{getComponentsMetadata:function(){var componentsMetadata=
[],sortedSectionsByOffsetTop=lib(elementType+"["+eleAttribute+"]").sort(function(a,b){var aTop=lib(a).offset().top,bTop=lib(b).offset().top;return aTop<bTop?-1:aTop>bTop?1:0});sortedSectionsByOffsetTop.each(function(index,element){var componentSize=getComponentSize(element),componentMetadata=getComponentsMetadataObject(lib(element).attr(eleAttribute));componentMetadata.source=getComponentSource(element);if(componentMetadata&&componentSize){componentMetadata.attributes.size=componentSize.row+"x"+componentSize.col;
componentMetadata.attributes.row=componentSize.row;componentMetadata.attributes.col=componentSize.col}componentsMetadata.push(componentMetadata)});return updateComponentsPosition(componentsMetadata)},findComponentMetadata:function(componentID){if(componentID&&win.digitalData&&win.digitalData.component&&win.digitalData.component.length)return lodash.find(win.digitalData.component,function(component){return component.componentInfo.componentID===componentID})},trackYoutubeVideos:function(){win.addEventListener("onVideoTrack",
function(e){var videoStatus="";switch(e.detail.state){case -1:videoStatus="UNSTARTED";break;case 0:videoStatus="ENDED";break;case 1:videoStatus="PLAYING";break;case 2:videoStatus="PAUSED";break;case 3:videoStatus="BUFFERING";break;case 5:videoStatus="CUED";break}lib(doc).trigger("video-interaction",{eventData:{origin:"youtube.com",action:videoStatus,metadata:{attributes:{assetID:e.detail&&e.detail.assetId||""},componentInfo:{componentID:e.detail&&e.detail.componentId||e.detail.assetId},category:{componentType:"video"}}}})})},
getComponentsMetadataObject:getComponentsMetadataObject,registerComponentClick:function(){lib(elementType+"["+eleAttribute+"] ["+clickAttribute+"]").click(function(e){var url=lib(this).attr("href")||"";var target=lib(this).attr("target")||"";if(url&&url!=="#"&&url.toLowerCase()!=="javascript:void(0)"&&url!==""&&target!=="_blank"){e.preventDefault();lib(this).attr("href","#")}var curElement=lib(this),componentID=curElement.attr(clickAttribute),componentMetadata=getComponentsMetadataObject(curElement.closest("["+
eleAttribute+"]").attr(eleAttribute));if(componentMetadata){componentMetadata.componentInfo.componentID=componentID;lib(doc).trigger("component-interaction",{eventData:{origin:"cq5",action:"click",metadata:componentMetadata}})}if(url&&url!=="#"&&url.toLowerCase()!=="javascript:void(0)"&&url!==""&&target!=="_blank")setTimeout(function(){lib(this).attr("href",url);location.href=url},1550)})}}}(),janrain:{notifyWhenReady:function(callback){win.dataLayer.utilities.watch(jrain,"federateJSLoaded",callback,
false)}},page:{notifyWhenReady:function(callback){lib(doc).on("readyToTrack",callback)},generateEvents:function(dataLayer,eventRules){if(!dataLayer||!eventRules||!eventRules.length)return dataLayer;lodash.forEach(eventRules,function(eventRule){if(!eventRule||!eventRule.events||!eventRule.events.length||!lodash.isFunction(eventRule.execute))return true;if(eventRule.execute())dataLayer.events=win.dataLayer.utilities.mergeCollection(dataLayer.events||[],eventRule.events).sort()});return dataLayer},getID:function(){var pid=
win.location.href.replace(win.location.origin,"");return pid==="/"?"Home":pid},getCategory:function(){var category={},brands=["coca-cola","diet-coke","coke-zero","sprite","dasani","powerade","minute-maid","fanta","barqs","fresca","mello-yello","fuze","seagrams"],partners=["disney","southwest"],path=win.location.pathname.toLowerCase().replace("/content/","/"),splitPaths=win.dataLayer.utilities.deleteFromArray(path.split("/"),""),lastSplitPart=splitPaths&&splitPaths.length>=1?splitPaths[splitPaths.length-
1].toLowerCase().replace(".html",""):"",brandIndex=brands.indexOf(lastSplitPart),partnerIndex=partners.indexOf(lastSplitPart),directoryToAdd=brandIndex>-1?"brands":"partners";if(brandIndex>-1||partnerIndex>-1)if(splitPaths.length>1)splitPaths[splitPaths.length-2]=directoryToAdd;else splitPaths.splice(0,0,directoryToAdd);category.primary=splitPaths[0];if(splitPaths.length>1)category.secondary=splitPaths[0]+"/"+splitPaths[1];return category},getFilename:function(){var urlPath=win.location.pathname.toLowerCase(),
urlPathParts=win.dataLayer.utilities.endsWith(urlPath,".html")?urlPath.split("/"):null;return urlPathParts&&urlPathParts.length?urlPathParts[urlPathParts.length-1]:undefined},getAuthProvider:function(){var janrainLastAuthMethod=win.dataLayer.utilities.supportsLocalStorage?win.localStorage.getItem("janrainLastAuthMethod"):null,traditionalSignIn="traditionalsignin",externalAuthProvider=cookieHelper("expected_tab");if(win.dataLayer.utilities.user.isLoggedIn())return janrainLastAuthMethod&&janrainLastAuthMethod.toLowerCase()!==
traditionalSignIn?externalAuthProvider:traditionalSignIn},registerForPostPageLoadEvents:function(){win.dataLayer.utilities.components.registerComponentClick();win.dataLayer.utilities.components.trackYoutubeVideos();if(win.spredfast)win.spredfast.exp("events.on","analytics",function(event){win.dataLayer.utilities.logMessage({type:"info",message:"Spreadfast event triggered",data:event});var data,asset="",iframeCtl,eleAttribute="impressionRegister";iframeCtl=$("[id*\x3d"+event.metadata.client.replace(/-/g,
"_")+"_"+event.metadata.name+"]");iframeCtl=iframeCtl.length>=1?iframeCtl:$("[id*\x3d"+event.metadata.client+"_"+event.metadata.name+"]");lib(iframeCtl).parents("section").each(function(index,value){if(lib(value).attr(eleAttribute))asset=lib(value).attr(eleAttribute)});if(event.eventName==="trackEvent"){data={eventData:{origin:"spredfast",action:event.eventData.category,metadata:{componentInfo:{componentID:event.metadata.name+"_"+event.metadata.componentID},category:{componentType:event.metadata.componentType},
attributes:{label:event.eventData.label,visualization:event.metadata.visualization,assetID:asset!==""?asset:event.metadata.name}}}};lib(doc).trigger("component-interaction",data)}})}},user:{getProfileInfo:function(){return win.dataLayer.utilities.supportsLocalStorage?win.dataLayer.utilities.safeJSONParse(win.localStorage.getItem("janrainCaptureReturnExperienceData")):null},getTier:function(){var tier=cookieHelper("AuthCookie");return!tier?undefined:tier==="true"?"lover":"drinker"},isLoggedIn:function(){return win.dataLayer.utilities.supportsLocalStorage?
!!win.localStorage.getItem("janrainCaptureToken"):false},isNewVisitor:function(){return!cookieHelper("pulseSession")},getMemberID:function(){return cookieHelper("memberIdentifier")}}};win.dataLayer.utilities.dlMappings=[{srcPath:"window.location.href",destPath:"pageInstanceID",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"derived.pageID",destPath:"page.pageInfo.pageID",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"document.title",
destPath:"page.pageInfo.pageName"},{srcPath:"derived.memberID",destPath:"user[0].profile[0].profileInfo.profileID"},{srcPath:"derived.profileInfo.displayName",destPath:"user[0].profile[0].profileInfo.userName"},{srcPath:"derived.profileInfo.email",destPath:"user[0].profile[0].profileInfo.email",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"derived.isNewVisitor",destPath:"user[0].profile[0].profileInfo.isNewVisitor"},{srcPath:"derived.tier",destPath:"user[0].segment.tier",
transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"derived.isLoggedIn",destPath:"user[0].profile[0].attributes.isLoggedIn"},{srcPath:"derived.authProvider",destPath:"user[0].profile[0].attributes.authProvider",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"derived.queryParams",destPath:"attributes.queryParams"},{srcPath:"derived.deviceInfo",destPath:"attributes.deviceInfo"},{srcPath:"derived.fileName",destPath:"page.attributes.content"},
{srcPath:"componentsMetadata",destPath:"component"},{srcPath:"derived.pageCategory.primary",destPath:"page.category.primaryCategory"},{srcPath:"derived.pageCategory.secondary",destPath:"page.category.subCategory"},{srcPath:"eventData.origin",destPath:"pplOrigin"},{srcPath:"eventData.action",destPath:"pplAction",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"eventData.isExternalLink",destPath:"pplIsExternalLink",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},
{srcPath:"eventData.metadata.componentInfo.componentID",destPath:"pplComponentID",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"eventData.metadata.category.primaryCategory",destPath:"pplPrimaryCategory",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"eventData.metadata.category.subCategory",destPath:"pplSubCategory"},{srcPath:"eventData.metadata.category.componentType",destPath:"pplComponentType"},{srcPath:"eventData.metadata.attributes.brandInterest",
destPath:"pplBrandInterest"},{srcPath:"eventData.metadata.attributes.ownedBy",destPath:"pplOwnedBy"},{srcPath:"eventData.metadata.attributes.assetID",destPath:"pplAssetID",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"eventData.metadata.attributes.label",destPath:"pplLabel"},{srcPath:"eventData.metadata.attributes.visualization",destPath:"pplVisualization"},{srcPath:"window.location.href",destPath:"page.pageInfo.destinationURL",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},
{srcPath:"document.referrer",destPath:"page.pageInfo.referringURL",transformations:[win.dataLayer.utilities.transformations.toLowerCase]},{srcPath:"window.location.host",destPath:"page.pageInfo.sysEnv"},{srcPath:"constants.language",destPath:"page.pageInfo.language"},{srcPath:"constants.country",destPath:"attributes.country"},{srcPath:"derived.session",destPath:"attributes.session"},{srcPath:"derived.jsession",destPath:"attributes.jsession"},{srcPath:"constants.version",destPath:"version"}]})(window,
document,console,jQuery,Bootstrapper,Bootstrapper.pulse,window.janrain,jQuery.cookie,lodash);(function(win,doc,lib,bootStrapper,jrain,utilities,pulse,userAgentParser){win.dataLayer.api=function(){var maxWaitTimeForDL=10,dlTimeoutHandle;win.digitalData={};function updateDLMapping(newDLMappings){utilities.dlMappings=utilities.mergeCollection(utilities.dlMappings,newDLMappings,function(item,key,a){return item?"srcPath"+(item.srcPath||"")+("destPath"+(item.destPath||"")):""})}function updateEventRules(newEventRules){utilities.eventRules=
utilities.mergeCollection(utilities.eventRules,newEventRules)}function registerSubscribers(eventSubscriptions){var plEventHandler=function(event,data){utilities.logMessage({type:"info",message:event.type+" triggered.",data:data});utilities.autoMap(utilities.dlMappings,data,win.digitalData)},pplEventHandler=function(event,data){var result={},resultArray,dataType="page.postpageload";utilities.logMessage({type:"info",message:event.type+" triggered.",data:data});if(utilities.dlMappings&&utilities.dlMappings.length&&
data){utilities.autoMap(utilities.dlMappings,data,result);if(result)utilities.dataCollect(win.digitalData,result,dataType);resultArray=utilities.objectToArray(result);pulse=pulse||win.Bootstrapper.pulse;if(resultArray&&pulse){pulse.collect();pulse.action(resultArray)}}};lib.each(eventSubscriptions,function(index,eventSubscription){var janrainEvent,eventHandler;if(!eventSubscription||!eventSubscription.eventName)return true;eventHandler=eventSubscription.eventPhase==="postpageload"?pplEventHandler:
plEventHandler;eventSubscription.eventType=eventSubscription.eventType||"jQuery";switch(eventSubscription.eventType){case "janrain":utilities.janrain.notifyWhenReady(function(){janrainEvent=jrain&&jrain.events?jrain.events[eventSubscription.eventName]:null;if(janrainEvent)janrainEvent.addHandler(function(data){var event={type:eventSubscription.eventName};if(eventSubscription.data){data=data||{};data=lodash.merge(data,eventSubscription.data)}(eventSubscription.fnEventHandler||eventHandler)(event,data);
if(eventSubscription.postEventHandler)eventSubscription.postEventHandler(event,data)})});break;default:lib(doc).on(eventSubscription.eventName,function(event,data){if(eventSubscription.data){data=data||{};data=lodash.merge(data,eventSubscription.data)}(eventSubscription.fnEventHandler||eventHandler)(event,data);if(eventSubscription.postEventHandler)eventSubscription.postEventHandler(event,data)});break}})}dlTimeoutHandle=setTimeout(function(){utilities.logMessage({type:"info",message:"Data layer not ready even after "+
maxWaitTimeForDL+" seconds."})},maxWaitTimeForDL*1E3);lib(doc).on("dl-page-ready",function(){utilities.logMessage({type:"info",message:"dl-page-ready triggered."});clearTimeout(dlTimeoutHandle);bootStrapper.dataManager.pushObject(utilities.page.generateEvents(win.digitalData,utilities.eventRules),"digitalData","Data Layer");lib(doc).trigger("edl-ready");setTimeout(function(){utilities.page.registerForPostPageLoadEvents()},0)});registerSubscribers([{eventName:"page-onLoad"},{eventName:"page-ajax-ready",
postEventHandler:function(){lib(doc).trigger("dl-page-ready")}},{eventName:"components-ready"},{eventName:"onCaptureLoginSuccess",eventType:"janrain",eventPhase:"postpageload",data:{eventData:{origin:"application",action:"login.success"}}},{eventName:"onCaptureRegistrationSuccess",eventType:"janrain",eventPhase:"postpageload",data:{eventData:{origin:"application",action:"signup.success"}}},{eventName:"component-interaction",eventPhase:"postpageload"},{eventName:"video-interaction",eventPhase:"postpageload"}]);
lib(doc).ready(function(){lib(doc).trigger("page-onLoad",{document:doc,constants:{language:"en-US",country:"us",version:"1.0"},derived:{pageID:utilities.page.getID(),isNewVisitor:utilities.user.isNewVisitor(),session:utilities.getSession(),queryParams:utilities.getQueryParameters(),jsession:utilities.getJSession(),pageCategory:utilities.page.getCategory(),deviceInfo:{device:userAgentParser.device,cpu:userAgentParser.cpu,os:userAgentParser.os,browser:userAgentParser.browser,engine:userAgentParser.engine},
fileName:function(){var urlPath=win.location.pathname.toLowerCase(),urlPathParts=utilities.endsWith(urlPath,".html")?urlPath.split("/"):null;return urlPathParts&&urlPathParts.length?urlPathParts[urlPathParts.length-1]:undefined}()}})});utilities.page.notifyWhenReady(function(){var componentsMetadata=utilities.components.getComponentsMetadata();if(componentsMetadata&&componentsMetadata.length)lib(doc).trigger("components-ready",{componentsMetadata:componentsMetadata});lib(doc).trigger("page-ajax-ready",
{window:win,derived:{profileInfo:utilities.user.getProfileInfo(),memberID:utilities.user.getMemberID(),tier:utilities.user.getTier(),isLoggedIn:utilities.user.isLoggedIn(),authProvider:utilities.page.getAuthProvider()}})});return{updateDLMapping:updateDLMapping,updateEventRules:updateEventRules,registerSubcribers:registerSubscribers}}()})(window,document,jQuery,Bootstrapper,window.janrain,dataLayer.utilities,Bootstrapper.pulse,jQuery.ua)},1964195,[1446537],328435,[328461]);
Bootstrapper.bindImmediate(function(){var Bootstrapper=window["Bootstrapper"];var ensightenOptions=Bootstrapper.ensightenOptions;Bootstrapper.pulse={config:{dc:"//ensighten.ccnag.com/no-content",debug:false,fpDomain:".us.coca-cola.com",sessionTime:18E5,avoidRefdomain:["coca-cola-ccna.janrainsso.com"]},params:{},metas:{},images:[],log:[],pEncode:function(string){if(typeof encodeURIComponent=="function")return encodeURIComponent(string);else return escape(string)},pDecode:function(string){if(typeof decodeURIComponent==
"function")try{return decodeURIComponent(encodeURIComponent(string))}catch(err){return""}else return unescape(string)},pDate:function(){if(!Date.now)Date.now=function now(){return(new Date).getTime()};else return Date.now()},pLog:function(m){this.log.push(m);if(this.config.debug)console.log("[ENS] "+m)},parseParams:function(string){if(typeof string==="string"){string=string.match("/;+$/")?string.replace(/;+$/,""):string;var parsed=string.split(";");var arrayLength=parsed.length;for(var i=0;i<arrayLength;i++)if(parsed[i]!==
"undefined")parsed[i]=this.pEncode(parsed[i]);return parsed.join(";")}else return string},parseUrl:function(url){var parser=document.createElement("a"),searchObject={},queries,split,i;parser.href=url;queries=parser.search.replace(/^\?/,"").split("\x26");for(i=0;i<queries.length;i++){split=queries[i].split(/=(.+)?/);searchObject[split[0]]=this.pDecode(split[1])}return{protocol:parser.protocol,host:parser.host,hostname:parser.hostname,port:parser.port,pathname:parser.pathname,search:parser.search,searchObject:searchObject,
hash:parser.hash}},setCookie:function(name,value,days){if(days){var date=new Date;date.setTime(date.getTime()+days*24*60*60*1E3);var expires="; expires\x3d"+date.toGMTString()}else var expires="";document.cookie=name+"\x3d"+value+expires+"; path\x3d/"},getCookie:function(name){var nameEQ=name+"\x3d";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null},
eraseCookie:function(name){createCookie(name,"",-1)},isEmpty:function(obj){if(typeof obj=="undefined"){this.pLog("Object is undefined");return true}for(var prop in obj)if(obj.hasOwnProperty(prop))return false;this.pLog(obj+" is empty");return true},collect:function(p){p=p||false;if(p==false){this.params={};this.params.enviro="web"}if(window.digitalData&&this.isEmpty(digitalData)!==true){this.params.ver=window.digitalData.version||"";this.params.pinstid=window.digitalData.pageInstanceID||"";if(window.digitalData.attributes.deviceInfo&&
window.digitalData.attributes.deviceInfo.device)this.params.channel=window.digitalData.attributes.deviceInfo.device.type?window.digitalData.attributes.deviceInfo.device.type.toLowerCase():"desktop";if(typeof window.digitalData.page.pageInfo!=="undefined"){this.params.desturl=window.digitalData.page.pageInfo.destinationURL||"";this.params.lang=window.digitalData.page.pageInfo.language||"";this.params.pageid=window.digitalData.page.pageInfo.pageID||"";this.params.pagename=window.digitalData.page.pageInfo.pageName||
"";this.params.refurl=window.digitalData.page.pageInfo.referringURL||"";this.params.sysenv=window.digitalData.page.pageInfo.sysEnv||""}if(this.config.avoidRefdomain&&this.config.avoidRefdomain.length>0&&Bootstrapper.pulse.params&&Bootstrapper.pulse.params.refurl)this.config.avoidRefdomain.forEach(function(val){if(Bootstrapper.pulse.params.refurl.toLowerCase().indexOf(val)>-1)this.params.refurl=""});if(typeof window.digitalData.page.attributes!=="undefined")this.params.content=window.digitalData.page.attributes.content||
"";if(typeof window.digitalData.page.category!=="undefined"){this.params.ppcat=window.digitalData.page.category.primaryCategory||"";this.params.pscat=window.digitalData.page.category.subCategory||""}if(typeof window.digitalData.user[0].profile[0].attributes!=="undefined"){this.params.isloggedin=window.digitalData.user[0].profile[0].attributes.isLoggedIn?window.digitalData.user[0].profile[0].attributes.isLoggedIn.toString():"false";this.params.uauth=window.digitalData.user[0].profile[0].attributes.authProvider||
""}if(typeof window.digitalData.user[0].profile[0].profileInfo!=="undefined"){this.params.upid=window.digitalData.user[0].profile[0].profileInfo.profileID||"";this.params.newvisitor=window.digitalData.user[0].profile[0].profileInfo.isNewVisitor.toString()||""}if(window.digitalData.attributes&&window.digitalData.attributes.deviceInfo){var device;if(window.digitalData.attributes.deviceInfo.device&&window.digitalData.attributes.deviceInfo.device.type&&window.digitalData.attributes.deviceInfo.device.type!==
""){device=window.digitalData.attributes.deviceInfo.device.vendor||"";device+=" "+window.digitalData.attributes.deviceInfo.device.model||"";device+=window.digitalData.attributes.deviceInfo.os.name?" - "+window.digitalData.attributes.deviceInfo.os.name:"";device+=" "+window.digitalData.attributes.deviceInfo.os.version||"";device+=window.digitalData.attributes.deviceInfo.browser.name?"("+window.digitalData.attributes.deviceInfo.browser.name+" browser)":""}else{device="Desktop - ";device+=window.digitalData.attributes.deviceInfo.os.name||
"";device+=" "+window.digitalData.attributes.deviceInfo.os.version||"";device+=window.digitalData.attributes.deviceInfo.browser.name?"("+window.digitalData.attributes.deviceInfo.browser.name+" browser)":""}this.params.devicetype=device||""}if(typeof window.digitalData.user[0].segment!=="undefined")this.params.utier=window.digitalData.user[0].segment.tier||"";if(typeof window.digitalData.component!=="undefined"){var cid="";for(i=0;i<window.digitalData.component.length;i++)cid+=window.digitalData.component[i].attributes.assetID+
"_"+window.digitalData.component[i].attributes.size+"_"+window.digitalData.component[i].attributes.position+";";this.params.caid=cid||""}if(typeof window.digitalData.component!=="undefined"){var cid="";for(i=0;i<window.digitalData.component.length;i++)cid+=window.digitalData.component[i].attributes.assetID+"_"+window.digitalData.component[i].attributes.size+"_"+window.digitalData.component[i].attributes.position+"~"+window.digitalData.component[i].source+";";this.params.casource=cid||""}}this.getQryValues("WT.|DCSext.|mc_id",
location.href.toLowerCase());this.getMeta("WT.|DCSext.");this.sessionID()},getScreen:function(){var w=window.innerWidth||document.body.clientWidth;var h=window.innerHeight||document.body.clientHeight;return w+"x"+h},getMeta:function(name){var p=name||".*";var reggie=new RegExp(p,"g");var metas=document.getElementsByTagName("meta");for(i=0;i<metas.length;i++)try{if(metas[i]["name"]&&metas[i]["name"].match(reggie)||metas[i].getAttribute("property")&&metas[i].getAttribute("property").match(reggie)){this.params[metas[i]["name"].split(/DCSext\.|WT\./).join("").toString()||
metas[i].getAttribute("property").toString()]=metas[i]["content"];this.metas[metas[i]["name"].toString()||metas[i].getAttribute("property").toString()]=metas[i];this.pLog("Meta tag found: "+metas[i]["outerHTML"])}}catch(e){this.pLog(e);break}},getQryValues:function(name,qry){var p=name||".*";var reggie=new RegExp(p,"g");var parsed=this.parseUrl(qry);for(var key in parsed.searchObject)if(parsed.searchObject&&key.match(reggie)){this.params[key.split(/DCSext\.|WT\./).join("").toString()]=parsed.searchObject[key];
this.pLog("Query parameter found: "+key+" \x3d "+parsed.searchObject[key])}},getParameterByName:function(field,url){var href=url?url:window.location.href;var reg=new RegExp("[?\x26]"+field+"\x3d([^\x26#]*)","i");var string=reg.exec(href);return string?string[1]:null},action:function(o){if(typeof o==="object")o={"p":Array.prototype.slice.call(o)};else o={"p":Array.prototype.slice.call(arguments)};for(i=0;i<o.p.length;i++){var k=o.p[i].split(/DCS\.|WT\./).join("").toString();var v=o.p[i+1].toString();
this.params[k]=v;i++}this.sessionID();this.track();this.pLog("Pulse action tracked")},sessionID:function(){var ranId=Math.floor(Math.random()*1E8+1);var pulseSessionId=this.pDate();var curT=this.pDate();var fpDomain=this.config.fpDomain;var pulseSession=this.getCookie("pulseSession")||"na";if(pulseSession!="na"){pulseSession=pulseSession.split(":");var sessTime=pulseSession[1];ranId=pulseSession[5];pulseSessionId=pulseSession[3];if(curT>=Number(sessTime)+this.config.sessionTime){pulseSessionId=this.pDate();
this.setCookie("pulseSession","lv:"+this.pDate()+":ss:"+pulseSessionId+":vid:"+ranId+";domain\x3d"+fpDomain,365);this.pLog("New Session")}else{this.setCookie("pulseSession","lv:"+this.pDate()+":ss:"+pulseSessionId+":vid:"+ranId+";domain\x3d"+fpDomain,365);this.pLog("Current Session")}}else{this.pLog("New Session");pulseSessionId=this.pDate();this.setCookie("pulseSession","lv:"+this.pDate()+":ss:"+pulseSessionId+":vid:"+ranId+";domain\x3d"+fpDomain,365)}var psid=ranId.toString()+"."+pulseSessionId.toString();
this.params.psid=psid},createQuery:function(obj){var string="";for(var key in obj)if(obj.hasOwnProperty(key)&&obj[key]!==""){var value=this.parseParams(obj[key]);string+=key+"\x3d"+value.toString()+"\x26"}string+="pset\x3d"+this.pDate();string=string.replace(/&+$/,"");return string},createImage:function(string){var elemImg=document.createElement("img");var protocol=window.location.protocol=="https:"?"https:":"http:";elemImg.src=protocol+this.config.dc+"?"+string;elemImg.style.cssText="display:none";
window.document.body.insertBefore(elemImg,window.document.body.firstChild);this.pLog("Pixel generated: "+elemImg.src)},track:function(){setTimeout(function(){Bootstrapper.pulse.params.jsession=Bootstrapper.pulse.getCookie("sessionUUID")||"";var pixel=Bootstrapper.pulse.createImage(Bootstrapper.pulse.createQuery(Bootstrapper.pulse.params));Bootstrapper.pulse.pLog("Hit generated");return pixel},600)}}},1983636,299309);Bootstrapper.getServerComponent(Bootstrapper.getExtraParams ? Bootstrapper.getExtraParams() : undefined);}})();